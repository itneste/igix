# 子表分页

## 概述

在表单使用中会遇到因子表数据量大导致切换行卡顿、点击保存或取消按钮等待时间长的问题。为了解决该问题，控制器集成了子表分页功能，启用子表分页后子表数据不会全部加载，而是仅加载某一页的数据，减少渲染次数及内存占用，以优化表单性能，提升表单使用体验。

## 适用场景

目前仅支持从表分页，不支持从从表分页。

## 运行效果

![](./images/children_pagination.gif)

## 开发步骤

### 1、升级WebCMP

升级webcmp至最新，升级后卡片的保存、取消、编辑等命令均新增了`是否启用子表分页`参数。

![image-20220110155608635](./images/image-20220110155608635.png)

### 2、修改DOM

切换到`代码编辑器`视图，在对于的`viewModel`中启用分页。

![image-20220110155923343](./images/image-20220110155923343.png)

### 3、添加命令

为实现切换页码及切换分页大小时加载不同分页的数据，需要在表格对应的视图模型中增加`切换页码`、`查询从表数据（分页）`命令并挂载到对应事件中。

其中切换页码命令位于列表控制器`ListController`，查询从表数据（分页）位于高级列卡控制器`AdvancedListCardController`。

> **切换页码命令参数配置：**
>
> 切换页码命令中`数据加载命令框架Id`为表格所在的frameId。
>
> 数据加载命令名称为`查询从表数据（分页）`对应的编号。

![image-20220110172056292](./images/image-20220110172056292.png)

将切换页码命令挂载到卡片的`切换页码事件`及`分页条数变化事件`

### 4、配置命令

配置`是否启用子表分页`参数为`true`，根据表单模板需配置以下命令：

> **卡片模板:**
>
> 加载并查看、加载并编辑、编辑数据、保存数据、删除子表数据、切换上一条或下一条。

> **高级列卡模板：**
>
> 加载卡片数据、编辑数据、保存数据、取消、删除子表数据、移除主表数据。

> **双列表模板：**
>
> 加载子列表数据

### 5、生成编译表单

生成编译表单并部署。

### 6、开发完成